
Searching for fold 1...
  Found good solution at attempt 1
  Final: test_overlap=0.000, val_overlap=0.000, balance=0.005

Searching for fold 2...
  Found good solution at attempt 6
  Final: test_overlap=0.042, val_overlap=0.040, balance=0.004

Searching for fold 3...
  Attempt 50: best test_overlap=0.171, val_overlap=0.069
  Attempt 100: best test_overlap=0.094, val_overlap=0.036
  Attempt 150: best test_overlap=0.128, val_overlap=0.000
  Attempt 200: best test_overlap=0.083, val_overlap=0.038
  Attempt 250: best test_overlap=0.200, val_overlap=0.077
  Attempt 300: best test_overlap=0.146, val_overlap=0.091
  Attempt 350: best test_overlap=0.077, val_overlap=0.115
  Attempt 400: best test_overlap=0.111, val_overlap=0.083
  Attempt 450: best test_overlap=0.152, val_overlap=0.043
  Final: test_overlap=0.060, val_overlap=0.045, balance=0.006

Searching for fold 4...
  Attempt 50: best test_overlap=0.130, val_overlap=0.083
  Attempt 100: best test_overlap=0.159, val_overlap=0.069
  Attempt 150: best test_overlap=0.085, val_overlap=0.042
  Attempt 200: best test_overlap=0.163, val_overlap=0.111
  Attempt 250: best test_overlap=0.119, val_overlap=0.136
  Attempt 300: best test_overlap=0.195, val_overlap=0.115
  Attempt 350: best test_overlap=0.125, val_overlap=0.038
  Attempt 400: best test_overlap=0.149, val_overlap=0.040
  Attempt 450: best test_overlap=0.146, val_overlap=0.190
  Final: test_overlap=0.082, val_overlap=0.048, balance=0.006

TOTAL clips: 458 | stable: 335 unstable: 123
Desired (approx):
 train -> stable~234.5 unstable~86.1
 val   -> stable~33.5 unstable~12.3
 test  -> stable~67.0 unstable~24.6

Created directory folds_diverse

FOLD 1/4 summary:
  train | subjects=103 | clips=320 | stable:unstable=234:86 | stable%=0.73
  val   | subjects=15 | clips= 47 | stable:unstable=34:13 | stable%=0.72
  test  | subjects=24 | clips= 91 | stable:unstable=67:24 | stable%=0.74
  -> wrote folds_diverse/fold1_subjects.csv
  test subjects (24): [3, 6, 12, 18, 39, 40, 49, 51, 53, 58, 59, 64, 112, 120, 128, 136, 1001, 1010, 1014, 1021, 1023, 1026, 1030, 1035]
  val  subjects (15): [14, 54, 60, 67, 70, 71, 72, 73, 76, 78, 94, 107, 114, 137, 1006]

FOLD 2/4 summary:
  train | subjects=105 | clips=320 | stable:unstable=234:86 | stable%=0.73
  val   | subjects=11 | clips= 46 | stable:unstable=34:12 | stable%=0.74
  test  | subjects=26 | clips= 92 | stable:unstable=67:25 | stable%=0.73
  -> wrote folds_diverse/fold2_subjects.csv
  test subjects (26): [22, 26, 31, 43, 55, 56, 58, 66, 71, 88, 104, 112, 116, 119, 121, 124, 126, 131, 1003, 1005, 1013, 1016, 1017, 1018, 1019, 1022]
  val  subjects (11): [9, 29, 40, 49, 73, 75, 91, 128, 135, 1030, 1033]

FOLD 3/4 summary:
  train | subjects=103 | clips=320 | stable:unstable=234:86 | stable%=0.73
  val   | subjects=12 | clips= 45 | stable:unstable=33:12 | stable%=0.73
  test  | subjects=27 | clips= 93 | stable:unstable=68:25 | stable%=0.73
  -> wrote folds_diverse/fold3_subjects.csv
  test subjects (27): [7, 14, 19, 22, 36, 37, 45, 46, 56, 57, 60, 70, 76, 87, 108, 109, 111, 118, 123, 125, 127, 135, 1011, 1015, 1018, 1023, 1031]
  val  subjects (12): [3, 4, 20, 28, 53, 68, 91, 95, 102, 1005, 1014, 1021]

FOLD 4/4 summary:
  train | subjects=105 | clips=320 | stable:unstable=234:86 | stable%=0.73
  val   | subjects=11 | clips= 45 | stable:unstable=33:12 | stable%=0.73
  test  | subjects=26 | clips= 93 | stable:unstable=68:25 | stable%=0.73
  -> wrote folds_diverse/fold4_subjects.csv
  test subjects (26): [4, 15, 18, 19, 29, 43, 50, 61, 64, 65, 68, 84, 89, 90, 91, 108, 122, 123, 129, 133, 134, 1006, 1011, 1026, 1028, 1029]
  val  subjects (11): [2, 17, 31, 38, 69, 70, 118, 120, 121, 125, 128]

============================================================
TEST SET OVERLAP MATRIX (Jaccard similarity)
============================================================
[[0.         0.04166667 0.02       0.06382979]
 [0.04166667 0.         0.06       0.01960784]
 [0.02       0.06       0.         0.08163265]
 [0.06382979 0.01960784 0.08163265 0.        ]]

Average test set overlap: 0.048
Max test set overlap: 0.082

============================================================
VAL SET OVERLAP MATRIX (Jaccard similarity)
============================================================
[[0.         0.04       0.         0.04      ]
 [0.04       0.         0.04545455 0.04761905]
 [0.         0.04545455 0.         0.        ]
 [0.04       0.04761905 0.         0.        ]]

Average val set overlap: 0.043
Max val set overlap: 0.048

============================================================
CHECKING WITHIN-FOLD OVERLAPS (should all be empty)
============================================================

============================================================
If overlap is too high, try:
  - Increasing --max_attempts (current: 500)
  - Decreasing --max_overlap (current: 0.05)
  - Changing --seed (current: 15)
